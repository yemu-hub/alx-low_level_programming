more functions and nessted loops
